# CompositionDetector.API.
данный детектор имеет один базовый метод detect (сигнатура которого - detect(self, frame), где frame - следующий обрабатываемый кадр). Суть алгоритма лежащего в основе этого метода, если кратко, в следующем: для каждого кадра текущие трекеры обновляются с одной стороны, а результаты анализа кадра покадровым детектором (HOG-детектором в нашем случае) анализируются и определяют редактирование и удаление существующих трекеров, а также порождение новых трекеров по принципу "жадного" увеличения уверенности.

сигнатура инициализации детектора следующая:
```
__init__(                                                        #
            self,                                                #
            detector:BaseDetector = DefaultBasedOnHOGDetector(), # покадровый детектор
            tracker_type:str = "CSRT",                           # тип единичного трекера, по умолчанию "CSRT", как показавший наилучшие результаты
            diff_threshold1 = 0.12,                              # гиперпараметр, анализируемый далее
            diff_threshold2 = 0.22,                              # гиперпараметр, анализируемый далее  
            confidence_threshold = 0.7,                          # гиперпараметр, анализируемый далее 
            colors_count = 7,                                    # кол-во цветов, используемых в раскраске трекеров          
            not_bigger_than_by = 1.1,                            # гиперпараметр, анализируемый далее            
            winStride = (8, 8),                                    # гиперпараметр, анализируемый далее
            **params)                                            # остальные гиперпараметры, для возможности быстрого времнного уточнения функциональности детектора
```
* ### Номер видео
Видео [POS1.mov](/MOT_pedestrians/data/people_on_street/POS1.mov),[POS2.mov](/MOT_pedestrians/data/people_on_street/POS2.mov),[POS3.mp4](/MOT_pedestrians/data/people_on_street/POS3.mp4) можно обнаружить в папке MOT_pedestrians/data/people_on_street 
* ### winStride
Выбранное по умолчанию значение окна гистаграммы (8,8) обозначается на оффициальном сайте библиотеки opencv, как стандарт. Но понижением размера например до (4,4) можно повысить recall и проиграть в precision. При этом уменьшится скорость обработки HOG-детектора, что приведёт к существенному (в 4 раза) замедлению. Повышение winStride до (16,16) наоборот приведёт к убыстрению в 4 раза и понижению recall за счёт повышения precision. winStride=(8,8) действительно даёт оптимальный результат для среднего видео, однако его следует подбирать отдельно если требуемый баланс между precision и recall в достаточной мере смещён. С течением времени winStride=(16,16) показывает большую стабильность и не теряет объекты, а winStride=(4,4) показывает в среднем лучший результат, но имеет склонность обнаруживать ложные объекты малых размеров. winStride напрямую влияет исключительно на поведение HOG-детектора, но не на работу с мультитрекингом.
* ### diff_threshold1
Смысл данного параметра заключается в пороге минимального допустимого различия между рамками двух разных трекеров. Практика показала, что идея лежащая в основе этого параметра чревата потерей объекта при достаточном близком перекрытии (один из трекеров “погибает” и это очень плохо для нашей задачи)
* ### diff_threshold2
diff_threshold2 – это порог различия между двумя рамками, который определяет, будет ли введён новый трекер (если рамка детектированная покадровым детектором отличается от всех детектированных трекерами хотя бы на diff_threshold2) и определяет, будет ли обновлён текущий (если рамка детектированная покадровым детектором отличается от детектированной одним из текущих трекеров менее, чем на diff_threshold2). Данный гиперпараметр является ядром алгоритма CompositionDetector. diff_threshold2 не должен быть слишком большим, чтобы детектор умел находить новый объект рядом со старым и не осуществлять ложное обновление, но при этом не должен и быть слишком малым, чтобы детектор не обманывался шумными детекциями покадрового-детектора. diff_threshold2 влияет на появление и удаление трекеров в момент выбора.
* ### confidence_threshold
Данный гиперпараметр определяет порог, по которому слишком сомнительные трекеры отсеиваются. При увеличении этого параметра понижается шум ошибок при трекинге и теряются потенциальные, но сомнительные трекеры. При уменьшении происходит обратный процесс: увеличивается шум и бывшие до того потенциальными трекеры становятся актуальными. Данный параметр, как оказалось, способен сильно повысить качество трекинга при надстройке на конкретную сцену съёмки.
* ### not_bigger_than_by
Введение данного гиперпараметра в алгоритм было мотивировано тем, что можно отсеивать ложные срабатывания детектора, если они соответствуют слишком сильному изменению размера рамки вокруг отслеживаемого объекта в течение одной смены кадра, и при этом поощрять уменьшение рамки для более точной детекции. Такого эффекта можно добиться при введении параметра not_bigger_than_by, который не позволяет рамке отслеживаемого объекта меняться больше, чем в фиксированное число раз в сторону увеличения (и это логично с той точки зрения, что размер человека за одну смену кадра не может слишком сильно измениться). При этом урезается увеличивающий поток, но сохраняется уменьшающий, что способствует уменьшению рамки в среднем. Влияние данного параметра не столь большое, как двух предыдущих. Параметр not_bigger_than_by прямым образом не влияет на появление и удаление трекеров. Но на жадное обновление влияет. 